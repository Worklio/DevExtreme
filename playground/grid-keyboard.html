
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>DX Grid Excel-like</title>
    <link rel="stylesheet" type="text/css" href="../artifacts/css/dx.common.css" />
    <link rel="stylesheet" type="text/css" href="../artifacts/css/dx.light.css" />
    <script type="text/javascript" src="../artifacts/js/jquery.js"></script>
    <!--<script type="text/javascript" src="../artifacts/js/cldr.js"></script>
    <script type="text/javascript" src="../artifacts/js/cldr/event.js"></script>
    <script type="text/javascript" src="../artifacts/js/cldr/supplemental.js"></script>
    <script type="text/javascript" src="../artifacts/js/cldr/unresolved.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/currency.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/date.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/message.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/number.js"></script>-->
    <script type="text/javascript" src="../artifacts/js/dx.all.debug.js"></script>

    

</head>
<body>
   <div id="dvFocusable" tabindex="0">
<div id="gridContainer"></div>
       </div>
  
   <script type="text/javascript">


       $(document).ready(function () {

           var data = [{
               "ID": 1,
               "FirstName": "John",
               "LastName": "Heart",
               "Prefix": "Mr.",
               "Position": "CEO",
               "BirthDate": "1964/03/16",
               "HireDate": "1995/01/15",
               "Address": "351 S Hill St.",
               "StateID": 5
           }, {
               "ID": 2,
               "FirstName": "Olivia",
               "LastName": "Peyton",
               "Prefix": "Mrs.",
               "Position": "Sales Assistant",
               "BirthDate": "1981/06/03",
               "HireDate": "2012/05/14",
               "Address": "807 W Paseo Del Mar",
               "StateID": 5
           }, {
               "ID": 3,
               "FirstName": "Robert",
               "LastName": "Reagan",
               "Prefix": "Mr.",
               "Position": "CMO",
               "BirthDate": "1974/09/07",
               "HireDate": "2002/11/08",
               "Address": "4 Westmoreland Pl.",
               "StateID": 4
           }, {
               "ID": 4,
               "FirstName": "Greta",
               "LastName": "Sims",
               "Prefix": "Ms.",
               "Position": "HR Manager",
               "BirthDate": "1977/11/22",
               "HireDate": "1998/04/23",
               "Address": "1700 S Grandview Dr.",
               "StateID": 11
           }, {
               "ID": 5,
               "FirstName": "Brett",
               "LastName": "Wade",
               "Prefix": "Mr.",
               "Position": "IT Manager",
               "BirthDate": "1968/12/01",
               "HireDate": "2009/03/06",
               "Address": "1120 Old Mill Rd.",
               "StateID": 13
           }, {
               "ID": 6,
               "FirstName": "Sandra",
               "LastName": "Johnson",
               "Prefix": "Mrs.",
               "Position": "Controller",
               "BirthDate": "1974/11/15",
               "HireDate": "2005/05/11",
               "Address": "4600 N Virginia Rd.",
               "StateID": 44
           }, {
               "ID": 7,
               "FirstName": "Kevin",
               "LastName": "Carter",
               "Prefix": "Mr.",
               "Position": "Shipping Manager",
               "BirthDate": "1978/01/09",
               "HireDate": "2009/08/11",
               "Address": "424 N Main St.",
               "StateID": 5
           }, {
               "ID": 8,
               "FirstName": "Cynthia",
               "LastName": "Stanwick",
               "Prefix": "Ms.",
               "Position": "HR Assistant",
               "BirthDate": "1985/06/05",
               "HireDate": "2008/03/24",
               "Address": "2211 Bonita Dr.",
               "StateID": 4
           }, {
               "ID": 9,
               "FirstName": "Kent",
               "LastName": "Samuelson",
               "Prefix": "Dr.",
               "Position": "Ombudsman",
               "BirthDate": "1972/09/11",
               "HireDate": "2009/04/22",
               "Address": "12100 Mora Dr",
               "StateID": 26
           }, {
               "ID": 10,
               "FirstName": "Taylor",
               "LastName": "Riley",
               "Prefix": "Mr.",
               "Position": "Network Admin",
               "BirthDate": "1982/08/14",
               "HireDate": "2012/04/14",
               "Address": "7776 Torreyson Dr",
               "StateID": 5
           }, {
               "ID": 11,
               "FirstName": "Sam",
               "LastName": "Hill",
               "Prefix": "Mr.",
               "Position": "Sales Assistant",
               "BirthDate": "1984/02/17",
               "HireDate": "2012/02/01",
               "Address": "645 Prospect Crescent",
               "StateID": 11
           }, {
               "ID": 12,
               "FirstName": "Kelly",
               "LastName": "Rodriguez",
               "Prefix": "Ms.",
               "Position": "Support Assistant",
               "BirthDate": "1988/05/11",
               "HireDate": "2012/10/13",
               "Address": "1601 W Mountain St.",
               "StateID": 5
           }, {
               "ID": 13,
               "FirstName": "Natalie",
               "LastName": "Maguirre",
               "Prefix": "Mrs.",
               "Position": "Trainer",
               "BirthDate": "1977/10/07",
               "HireDate": "2008/06/19",
               "Address": "6400 E Bixby Hill Rd",
               "StateID": 29
           }, {
               "ID": 14,
               "FirstName": "Walter",
               "LastName": "Hobbs",
               "Prefix": "Mr.",
               "Position": "Programmer",
               "BirthDate": "1984/12/24",
               "HireDate": "2011/02/17",
               "Address": "10385 Shadow Oak Dr",
               "StateID": 13
           }];
           var currentColumnIndex = -1;
           function ShiftRow(currentRowIndex, shiftCount) {

               var targetRow = currentRowIndex + shiftCount;
               if (targetRow >= 0) {
                   if (grid.getRowElement(targetRow) != undefined) {
                       grid.editCell(targetRow, currentColumnIndex);
                   }
               }
           }

           function ShiftColumn(currentRowIndex, shiftCount) {
               var targetColumn = currentColumnIndex + shiftCount;

               if (targetColumn >= 0) {
                   if (targetColumn < grid.columnCount()) {
                       grid.editCell(currentRowIndex, targetColumn);
                   }
               }
           }
           function SelectNexRow(currentRowIndex) {
               ShiftRow(currentRowIndex, 1);
           }

           function SelectPreviousRow(currentRowIndex) {
               ShiftRow(currentRowIndex, -1);
           }

           function SelectPreviousColumn(currentRowIndex) {
               ShiftColumn(currentRowIndex, -1);
           }

           function SelectNextColumn(currentRowIndex) {
               ShiftColumn(currentRowIndex, 1);
           }
           function SelectNextColumnByEnter(currentRowIndex) {
               ShiftRow(currentRowIndex, 1);
           }
           var mapKeysToHandlers = {
               ArrowUp: SelectPreviousRow,
               ArrowDown: SelectNexRow,
               ArrowLeft: SelectPreviousColumn,
               ArrowRight: SelectNextColumn,
               Enter: SelectNextColumnByEnter
           };

           var grid = $("#gridContainer")
               .dxDataGrid({
                   dataSource: data,
                   columnAutoWidth: true,
                   keyExpr: "ID",
                   allowColumnReordering: true,
                   editing: {
                       mode: "cell",
                       allowUpdating: true,
                       allowDeleting: false,
                       allowAdding: true
                   },
                   onEditorPreparing: function (args) {
                       args.editorOptions.onKeyDown = function (e) {
                           var findHandler = mapKeysToHandlers[e.event.key];
                           var key = e.event.key;
                           var rowIndex = args.row.rowIndex;
                           var columnIndex = args.index;
                           var shiftRow = 0;
                           var shiftColumn = 0;

                           switch (key) {
                               case "ArrowUp": shiftRow = -1; break;
                               case "ArrowDown": shiftRow = 1; break;
                               case "ArrowLeft": shiftColumn = -1; break;
                               case "ArrowRight": shiftColumn = 1; break;
                               case "Enter": shiftRow = 1; break;
                           }
                           
                           var targetRowIndex = rowIndex + shiftRow;
                           var targetColumnIndex = columnIndex + shiftColumn;                           

                           if ((targetColumnIndex >= 0) && (targetRowIndex >= 0) && (targetColumnIndex < args.component.columnCount()) && (targetRowIndex < args.component.totalCount())) {

                               if (findHandler) {

                                   $("#dvFocusable").focus(); // to save edit data
                                   findHandler(args.row.rowIndex);
                                   e.event.preventDefault();
                                   e.event.stopPropagation();

                               }
                           }

                       };
                   },
                   onEditingStart: function (e) {
                       currentColumnIndex = grid.getController("columns")
                           .getVisibleIndex(grid.columnOption(e.column.dataField, "index"));

                   },
                   showBorders: true,
               }).dxDataGrid("instance")


       });

   </script>
</body>
</html>
